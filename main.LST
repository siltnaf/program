C51 COMPILER V9.54   MAIN                                                                  04/25/2020 03:29:19 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE MAIN
OBJECT MODULE PLACED IN Main.OBJ
COMPILER INVOKED BY: c:\Keil_v5\C51\BIN\C51.EXE Main.c OMF2 ROM(COMPACT) OPTIMIZE(8,SPEED) BROWSE DEBUG TABS(2)

line level    source

   1          
   2          #include "STC15F104E.h"
   3          
   4          #include "./public/inc/config.h" 
   5          #include "./public/inc/delay.h"  
   6          #include "./public/inc/init.h"
   7          #include "./public/inc/process.h"
   8          
   9          
  10          uint8 state,next_state,switch_state,switch_update;
  11          uint8 BUZ_on, UV_on,Fan_on, LED_type, O3_level, USB_charge;
  12          uint16 process_time,buz_time;
  13          
  14          
  15          
  16          void Update_switch()
  17          {
  18   1        
  19   1        if (switch_update==1)
  20   1          switch (switch_state)
  21   1            {
  22   2              case 0:     state=standby_mode;
  23   2                          break;
  24   2              case 1:     state=O3_mode;
  25   2                          break;
  26   2              case 2:     state=UVO3_mode;
  27   2                          break;
  28   2            } 
  29   1        switch_update=0;
  30   1        if (switch_state>2) switch_state=0;
  31   1        
  32   1      }
  33                
  34              
  35              
  36              
  37            
  38            
  39            
  40          
  41          void State_process()
  42          {
  43   1          switch (state)
  44   1          {
  45   2        
  46   2        case standby_mode:    
  47   2                            
  48   2                    
  49   2                          BUZ_on = 0;
  50   2                          LED_type = 0;
  51   2                          O3_level  = 0;
  52   2                          UV_on  = 0;
  53   2                          Fan_on = 0;       
  54   2                          next_state=standby_mode;
  55   2                          break;
C51 COMPILER V9.54   MAIN                                                                  04/25/2020 03:29:19 PAGE 2   

  56   2        
  57   2        case O3_mode:       
  58   2                          BUZ_on=0;
  59   2                          LED_type=1;
  60   2                          O3_level=1;
  61   2                          UV_on=0;
  62   2                          if (USB_charge==1) Fan_on=1; else Fan_on=0;
  63   2                          next_state=O3_mode;
  64   2                          break;
  65   2        
  66   2        case UVO3_mode:     
  67   2                          BUZ_on=0;
  68   2                          LED_type=2;
  69   2                          O3_level=2;
  70   2                          UV_on=1;
  71   2                          Fan_on=1;
  72   2                          if (process_time>time_4min) next_state=UV_mode; else next_state=UVO3_mode;
  73   2                          break;
  74   2        
  75   2        
  76   2        case UV_mode: 
  77   2                          BUZ_on=0;
  78   2                          LED_type=2;
  79   2                          O3_level=0;
  80   2                          UV_on=1;
  81   2                          Fan_on=1;
  82   2                          if (process_time>time_5min) 
  83   2                          {
  84   3                            buz_time=0;
  85   3                            next_state=BUZ_mode; 
  86   3                          }
  87   2                            else next_state=UV_mode;
  88   2                          break;
  89   2                          
  90   2        case BUZ_mode:
  91   2                          BUZ_on=1;
  92   2                          if (buz_time>time_5s) next_state=standby_mode;
  93   2                          break;
  94   2        
  95   2          }
  96   1          
  97   1      state=next_state;
  98   1      
  99   1      
 100   1      }
 101          
 102          
 103          
 104          
 105          
 106          
 107          
 108          
 109          
 110          void main(void) 
 111          {
 112   1        IO_Init();
 113   1        InitTime0();
 114   1        InitExtInterrupt();
 115   1      
 116   1        InitParameter() ;
 117   1        while(1) 
C51 COMPILER V9.54   MAIN                                                                  04/25/2020 03:29:19 PAGE 3   

 118   1        { 
 119   2          Update_switch();
 120   2          State_process();
 121   2          Process_FAN();
 122   2          Process_UV();
 123   2          Process_LED();
 124   2          Process_BUZ();
 125   2          Process_O3();
 126   2        } 
 127   1      }
 128          
 129          void isr_int0() interrupt 0
 130          {
 131   1         if ((switch_update==0) && (SW==1))
 132   1         {
 133   2            switch_state++;
 134   2            switch_update=1;
 135   2         }
 136   1      }
 137          
 138          void isr_int1() interrupt 2
 139          {
 140   1         
 141   1      }
 142          
 143          
 144          // 定时器0中断处理函数
 145          void isr_timer0() interrupt 1
 146          {
 147   1        UV=~UV;
 148   1      
 149   1      }
 150          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    374    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =     14    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
