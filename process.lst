C51 COMPILER V9.54   PROCESS                                                               06/02/2020 20:08:50 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE PROCESS
OBJECT MODULE PLACED IN process.obj
COMPILER INVOKED BY: c:\Keil_v5\C51\BIN\C51.EXE Public\src\process.c OMF2 ROM(COMPACT) OPTIMIZE(8,SPEED) BROWSE DEBUG PR
                    -INT(.\process.lst) TABS(2) OBJECT(process.obj)

line level    source

   1          
   2          #include "./public/inc/config.h"  
   3          #include "./public/inc/delay.h"  
   4          #include "./public/inc/init.h"
   5          #include "./public/inc/process.h"
   6          #include "STC15F104E.h"
   7          #include <intrins.h>
   8          
   9          
  10          
  11          
  12          void Process_Timer()
  13          {
  14   1      
  15   1        if (Timer_update==1)
  16   1        {
  17   2          
  18   2          Time_us++;    
  19   2          Timer_update=0; 
  20   2          if (Time_us>=4)
  21   2            {
  22   3              Time_us=0;
  23   3              Time_ms++;
  24   3            }
  25   2          
  26   2      
  27   2          if (Time_ms>=1000) 
  28   2            {
  29   3              
  30   3              Time_ms=0;
  31   3              Time_sec++;
  32   3            }
  33   2          if (Time_sec>=60)
  34   2            {
  35   3          
  36   3              Time_sec=0;
  37   3              Time_min++;
  38   3            }
  39   2          
  40   2        } 
  41   1      
  42   1      
  43   1      }
  44          
  45          
  46          
  47          
  48          void Process_UV()
  49          {
  50   1        if (UV_on==1)
  51   1        {
  52   2        
  53   2          if((Time_us%2)==0) UV=0;
  54   2             else UV=1;
C51 COMPILER V9.54   PROCESS                                                               06/02/2020 20:08:50 PAGE 2   

  55   2        }
  56   1        else UV=0;
  57   1      
  58   1      }
  59          
  60          void Process_O3()
  61          {
  62   1        switch (O3_level)
  63   1        {
  64   2          case 0:      
  65   2                        
  66   2                        O3=0;
  67   2                        break;
  68   2          case 1:      
  69   2                        switch (Time_sec%4)
  70   2                        {
  71   3                          case 0,1:           
  72   3                                              O3=1;
  73   3                                              break;
  74   3                          
  75   3                          case 2:             
  76   3                                              O3=1;             //enable every 1 out of 3sec        
  77   3                                              break;
  78   3                          
  79   3                          case 3:            
  80   3                                              O3=0;
  81   3                                              break;
  82   3                        }                 
  83   2                        break;
  84   2          case 2:       
  85   2                      
  86   2                        O3=1;
  87   2                        break;
  88   2        }
  89   1      }
  90          
  91          void Process_BUZ()
  92          {
  93   1       
  94   1        
  95   1      if (Beep==0) 
  96   1      {
  97   2        
  98   2        
  99   2          //P32 as input
 100   2        //                      P3M1   P3M0
 101   2        //P30(BUZ)->INPUT         1      1
 102   2        //P31(LED)->CMOS          0      1
 103   2        //P32(SW/BUZ)->INPUT      1      0
 104   2        //P33(O3)->OUTPUT         0      0
 105   2        //P34(UV)->CMOS           0      1
 106   2        //P35(ION)->OUTPUT        0      0
 107   2              
 108   2      
 109   2        //P3M1 |=0b0000 0100;
 110   2        //P3M0 &=0b1111 1011;
 111   2        
 112   2        
 113   2          P3M1 |= 0x04;               //P32 as input  
 114   2          P3M0 &= 0xfb;
 115   2      }
 116   1      
C51 COMPILER V9.54   PROCESS                                                               06/02/2020 20:08:50 PAGE 3   

 117   1        
 118   1      
 119   1      
 120   1      
 121   1      }
 122          
 123          
 124          void Process_LED()
 125          {
 126   1      if (Beep==0)
 127   1      {
 128   2        switch (LED_type)
 129   2            {
 130   3              case 0:     LED=0;
 131   3                          break;
 132   3              case 1:     LED=1;
 133   3                          break;
 134   3              case 2:     
 135   3                          if (Time_sec%2==0) LED=1;else LED=0;
 136   3                          break;
 137   3            } 
 138   2      }
 139   1      }
 140          
 141          
 142          void Process_ION()
 143            
 144          {
 145   1      
 146   1          //P35 as output
 147   1        //                      P3M1   P3M0
 148   1        //P30(BUZ)->INPUT         1      1
 149   1        //P31(LED/BUZ)->CMOS      0      1
 150   1        //P32(SW)->INPUT          1      0
 151   1        //P33(O3)->OUTPUT         0      0
 152   1        //P34(UV)->CMOS           0      1
 153   1        //P35(ION)->OUTPUT         0     0
 154   1              
 155   1            
 156   1               P3M1 &=0xdf;                      //P3M1 &=0b11011111;
 157   1               P3M0 &=0xdf;                      //P3M0 |=0b00100000;
 158   1        
 159   1        
 160   1        
 161   1        
 162   1        
 163   1        if (ION_on==1) ION=1; else ION=0;
 164   1              
 165   1      
 166   1        
 167   1        
 168   1      }
 169          
 170          
 171          void Process_sleep()
 172            
 173          {
 174   1      
 175   1        
 176   1        if ((Time_min>=time_1min) && (state==standby_mode))
 177   1        {
 178   2          PCON|=0x02;
C51 COMPILER V9.54   PROCESS                                                               06/02/2020 20:08:50 PAGE 4   

 179   2          _nop_ ();
 180   2          
 181   2          
 182   2          _nop_ ();
 183   2          _nop_ ();
 184   2          _nop_ ();
 185   2          _nop_ ();
 186   2          _nop_ ();
 187   2          _nop_ ();
 188   2          _nop_ ();
 189   2          _nop_ ();
 190   2          _nop_ ();
 191   2          _nop_ ();
 192   2          
 193   2          
 194   2          
 195   2        }
 196   1      
 197   1        
 198   1        
 199   1      }
 200          
 201          
 202          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    239    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
