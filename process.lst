C51 COMPILER V9.54   PROCESS                                                               12/13/2020 23:49:12 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE PROCESS
OBJECT MODULE PLACED IN process.obj
COMPILER INVOKED BY: c:\Keil_v5\C51\BIN\C51.EXE Public\src\process.c OMF2 ROM(COMPACT) OPTIMIZE(8,SPEED) BROWSE DEBUG PR
                    -INT(.\process.lst) TABS(2) OBJECT(process.obj)

line level    source

   1          
   2          #include "./public/inc/config.h"  
   3          #include "./public/inc/delay.h"  
   4          #include "./public/inc/init.h"
   5          #include "./public/inc/process.h"
   6          #include "STC15F104E.h"
   7          #include <intrins.h>
   8          
   9          
  10          
  11          
  12          void Process_Timer()
  13          {
  14   1      
  15   1        if (Timer_update==1)
  16   1        {
  17   2          
  18   2          Time_us++;    
  19   2          Timer_update=0; 
  20   2          if (Time_us>=4)
  21   2            {
  22   3              Time_us=0;
  23   3              Time_ms++;
  24   3            }
  25   2          
  26   2      
  27   2          if (Time_ms>=1000) 
  28   2            {
  29   3              
  30   3              Time_ms=0;
  31   3              if (scan==1) scan_sec++;
  32   3              power_refresh++;
  33   3              Time_sec++;
  34   3            }
  35   2          if (Time_sec>=60)
  36   2            {
  37   3          
  38   3              Time_sec=0;
  39   3              Time_min++;
  40   3            }
  41   2          
  42   2          if (Time_min>=60)
  43   2            {
  44   3              Time_min=0;
  45   3            }
  46   2            
  47   2            
  48   2        } 
  49   1      
  50   1      
  51   1      }
  52          
  53          
  54          
C51 COMPILER V9.54   PROCESS                                                               12/13/2020 23:49:12 PAGE 2   

  55          
  56          void Process_UV()
  57          {
  58   1        if ((UV_on==1))
  59   1        {
  60   2          UV=1;
  61   2        
  62   2      //    if((Time_us%2)==0) UV=0;
  63   2      //       else UV=1;
  64   2        }
  65   1        else UV=0;
  66   1      
  67   1      }
  68          
  69          void Process_O3()
  70          {
  71   1        switch (O3_level)
  72   1        {
  73   2          case 0:      
  74   2                        
  75   2                        O3_on=0;
  76   2                        break;
  77   2          case 1:      
  78   2                        switch (Time_sec%4)
  79   2                        {
  80   3                          case 0,1:           
  81   3                                              O3_on=1;
  82   3                                              break;
  83   3                          
  84   3                          case 2:             
  85   3                                              O3_on=1;              //enable every 1 out of 3sec        
  86   3                                              break;
  87   3                          
  88   3                          case 3:            
  89   3                                              O3_on=0;
  90   3                                              break;
  91   3                        }                 
  92   2                        break;
  93   2          case 2:       
  94   2                      
  95   2                        O3_on=1;
  96   2                        break;
  97   2        }
  98   1      }
  99          
 100          void Process_BUZ()
 101          {
 102   1       
 103   1        
 104   1      if (Beep==0) 
 105   1      {
 106   2        
 107   2        
 108   2        
 109   2        
 110   2         SET_INPUT(IO_BUZ);
 111   2          
 112   2      }
 113   1      
 114   1        
 115   1      
 116   1      
C51 COMPILER V9.54   PROCESS                                                               12/13/2020 23:49:12 PAGE 3   

 117   1      
 118   1      }
 119          
 120          
 121          void Process_LED()
 122          {
 123   1      if ((Beep==0))
 124   1      {
 125   2        switch (LED_type)
 126   2            {
 127   3              case 0:     
 128   3                
 129   3                          
 130   3                          SET_INPUT(IO_LED);
 131   3                          
 132   3                          break;
 133   3              case 1:     
 134   3                          SET_CMOS(IO_LED);
 135   3                          LED=0;
 136   3                          break;
 137   3              case 2:     
 138   3                          SET_CMOS(IO_LED);
 139   3                          LED=1;
 140   3                          break;
 141   3              case 3:     
 142   3                           
 143   3                          if (Time_sec%2==0) 
 144   3                          {
 145   4                            SET_CMOS(IO_LED);
 146   4                            LED=0;
 147   4                          }
 148   3                          else 
 149   3                          {
 150   4                            SET_INPUT(IO_LED);
 151   4                          }
 152   3                          break;
 153   3              case 4:     
 154   3                           
 155   3                          if (((Time_us%512)==0) && ((Time_sec%4)==0))
 156   3                          {
 157   4                            SET_CMOS(IO_LED);
 158   4                            LED=0;
 159   4                          }
 160   3                          else 
 161   3                          {
 162   4                            SET_INPUT(IO_LED);
 163   4                          }
 164   3                          break;      
 165   3                          
 166   3            } 
 167   2      }
 168   1      }
 169          
 170          
 171          void Process_ION()
 172            
 173          {
 174   1      
 175   1        SET_OUTPUT(IO_ION);
 176   1              
 177   1            
 178   1        
C51 COMPILER V9.54   PROCESS                                                               12/13/2020 23:49:12 PAGE 4   

 179   1        
 180   1        
 181   1        
 182   1        if (ION_on==1) ION=1; else ION=0;
 183   1              
 184   1      
 185   1        
 186   1        
 187   1      }
 188          
 189          
 190          void Process_sleep()
 191            
 192          {
 193   1      
 194   1        
 195   1        if ((Time_min>=time_1min) && (state==standby_mode))
 196   1        {
 197   2          EX1=1;
 198   2          EX0=1;
 199   2          SW1=0;
 200   2      //    SW2=0;
 201   2      //    SET_INPUT(IO_SW2);
 202   2          SET_INPUT(IO_SW1);
 203   2          
 204   2         
 205   2          PCON|=0x02;
 206   2          _nop_ ();
 207   2          
 208   2          
 209   2          _nop_ ();
 210   2          _nop_ ();
 211   2          _nop_ ();
 212   2          _nop_ ();
 213   2          _nop_ ();
 214   2          _nop_ ();
 215   2          _nop_ ();
 216   2          _nop_ ();
 217   2          _nop_ ();
 218   2          _nop_ ();
 219   2          
 220   2          
 221   2          
 222   2        }
 223   1      
 224   1        
 225   1        
 226   1      }
 227          
 228          
 229          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    322    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
C51 COMPILER V9.54   PROCESS                                                               12/13/2020 23:49:12 PAGE 5   

   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
